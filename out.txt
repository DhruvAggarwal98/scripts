- name: |
    Control-ID: 1.1.1.1
    Title: Ensure mounting of cramfs filesystems is disabled
    Description: The `cramfs` filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A `cramfs` image can be used without having to first decompress the image.
    Rationale: Removing support for unneeded filesystem types reduces the local attack surface of the server. If this filesystem type is not needed, disable it.
  module:

- name: |
    Control-ID: 1.1.1.3
    Title: Ensure mounting of udf filesystems is disabled
    Description: The `udf` filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support writing DVDs and newer optical disc formats.
    Rationale: Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.
  module:

- name: |
    Control-ID: 1.1.2
    Title: Ensure /tmp is configured
    Description: The `/tmp` directory is a world-writable directory used for temporary storage by all users and some applications.

_Notes:_
- _If an entry for /tmp exists in /etc/fstab it will take precedence over entries in the tmp.mount file._
- _`tmpfs` can be resized using the size={size} parameter in `/etc/fstab` or on the Options line in the tmp.mount file. If we don't specify the size, it will be half the RAM._

Resize `tmpfs` examples:
- `/etc/fstab`
```
 tmpfs /tmp tmpfs rw,noexec,nodev,nosuid,size=2G 0 0
```
- `tmp.mount`
```
 [Mount]
 What=tmpfs
 Where=/tmp
 Type=tmpfs
 Options=mode=1777,strictatime,size=2G,noexec,nodev,nosuid
```
    Rationale: Making /tmp its own file system allows an administrator to set the noexec option on the mount, making /tmp useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.

This can be accomplished by either mounting tmpfs to /tmp, or creating a separate partition for /tmp.
  module:

- name: |
    Control-ID: 1.1.3
    Title: Ensure noexec option set on /tmp partition
    Description: The `noexec` mount option specifies that the filesystem cannot contain executable binaries.
    Rationale: Since the `/tmp` filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from `/tmp` .
  module:

- name: |
    Control-ID: 1.1.4
    Title: Ensure nodev option set on /tmp partition
    Description: The `nodev` mount option specifies that the filesystem cannot contain special devices.
    Rationale: Since the `/tmp` filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in `/tmp` .
  module:

- name: |
    Control-ID: 1.1.5
    Title: Ensure nosuid option set on /tmp partition
    Description: The `nosuid` mount option specifies that the filesystem cannot contain `setuid` files.
    Rationale: Since the `/tmp` filesystem is only intended for temporary file storage, set this option to ensure that users cannot create `setuid` files in `/tmp`.
  module:

- name: |
    Control-ID: 1.1.6
    Title: Ensure /dev/shm is configured
    Description: `/dev/shm` is a traditional shared memory concept. One program will create a memory portion, which other processes (if permitted) can access. Mounting `tmpfs` at `/dev/shm` is handled automatically by systemd.

_Notes:_
- _An entry for `/dev/shm` in `/etc/fstab` will take precedence._
- _`tmpfs` can be resized using the size={size} parameter in `/etc/fstab`. If we don't specify the size, it will be half the RAM._

_Resize `tmpfs` example:_
```
 tmpfs /dev/shm tmpfs defaults,noexec,nodev,nosuid,size=2G 0 0
```
    Rationale: Any user can upload and execute files inside the `/dev/shm` similar to the `/tmp` partition. Configuring `/dev/shm` allows an administrator to set the `noexec` option on the mount, making `/dev/shm` useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.
  module:

- name: |
    Control-ID: 1.1.7
    Title: Ensure noexec option set on /dev/shm partition
    Description: The `noexec` mount option specifies that the filesystem cannot contain executable binaries.

_Note: `/dev/shm` is mounted automatically by systemd. `/dev/shm` needs to be added to `/etc/fstab` to add mount options even though it is already being mounted on boot._
    Rationale: Setting this option on a file system prevents users from executing programs from shared memory. This deters users from introducing potentially malicious software on the system.
  module:

- name: |
    Control-ID: 1.1.8
    Title: Ensure nodev option set on /dev/shm partition
    Description: The `nodev` mount option specifies that the filesystem cannot contain special devices.

_Note: `/dev/shm` is mounted automatically by systemd. `/dev/shm` needs to be added to `/etc/fstab` to add mount options even though it is already being mounted on boot._
    Rationale: Since the `/dev/shm` filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create special devices in `/dev/shm` partitions.
  module:

- name: |
    Control-ID: 1.1.9
    Title: Ensure nosuid option set on /dev/shm partition
    Description: The `nosuid` mount option specifies that the filesystem cannot contain `setuid` files.

_Note: `/dev/shm` is mounted automatically by systemd. `/dev/shm` needs to be added to `/etc/fstab` to add mount options even though it is already being mounted on boot._
    Rationale: Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them.
  module:

- name: |
    Control-ID: 1.1.12
    Title: Ensure noexec option set on /var/tmp partition
    Description: The `noexec` mount option specifies that the filesystem cannot contain executable binaries.
    Rationale: Since the `/var/tmp` filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from `/var/tmp` .
  module:

- name: |
    Control-ID: 1.1.13
    Title: Ensure nodev option set on /var/tmp partition
    Description: The `nodev` mount option specifies that the filesystem cannot contain special devices.
    Rationale: Since the `/var/tmp` filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in `/var/tmp` .
  module:

- name: |
    Control-ID: 1.1.14
    Title: Ensure nosuid option set on /var/tmp partition
    Description: The `nosuid` mount option specifies that the filesystem cannot contain `setuid` files.
    Rationale: Since the `/var/tmp` filesystem is only intended for temporary file storage, set this option to ensure that users cannot create `setuid` files in `/var/tmp` .
  module:

- name: |
    Control-ID: 1.1.18
    Title: Ensure nodev option set on /home partition
    Description: The `nodev` mount option specifies that the filesystem cannot contain special devices.

_Note: The actions in this recommendation refer to the `/home` partition, which is the default user partition. If you have created other user partitions, it is recommended that the Remediation and Audit steps be applied to these partitions as well._
    Rationale: Since the user partitions are not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices.
  module:

- name: |
    Control-ID: 1.1.19
    Title: Ensure noexec option set on removable media partitions
    Description: The `noexec` mount option specifies that the filesystem cannot contain executable binaries.
    Rationale: Setting this option on a file system prevents users from executing programs from the removable media. This deters users from being able to introduce potentially malicious software on the system.
  module:

- name: |
    Control-ID: 1.1.20
    Title: Ensure nodev option set on removable media partitions
    Description: The `nodev` mount option specifies that the filesystem cannot contain special devices.
    Rationale: Removable media containing character and block special devices could be used to circumvent security controls by allowing non-root users to access sensitive device files such as `/dev/kmem` or the raw disk partitions.
  module:

- name: |
    Control-ID: 1.1.21
    Title: Ensure nosuid option set on removable media partitions
    Description: The `nosuid` mount option specifies that the filesystem cannot contain `setuid` files.
    Rationale: Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them.
  module:

